#: import Factory kivy.factory.Factory
#: include SC_App_Popup.kv
#: include SC_Widgets.kv

<MyLayout>:
    #Wallet_Balance: Wallet_Balance
    wallet_balance_sc: wallet_balance_sc
    do_default_tab: False
    tab_width: 200
    tab_height: 40
    size_hint: 1, 1
    pos_hint: {'center_x': .5, 'center_y': .5}
    tab_pos: 'top_left'
    # top_right, top_left, bottom_right, bottom_left, bottom_middle, right_top, left_top

    TabbedPanelItem:
        text: '[size=20][color=#ff8000][b]Connect to SC[/b][/color][/size]'
        BoxLayout:
            orientation: 'vertical'
            spacing: 3
            padding: 3
            row_force_default: True
            row_default_height: 20
            # Background color in Tab
            canvas:
                Color:
                    rgba: (1, 1/2, 0, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos
            # Load Smart Contract
            GridLayout:
                rows: 1
                cols: 4
                spacing: 2.5
                padding: 2.5
                size_hint: 1, .09
                StandardButton:
                    text: 'Clear'
                    size_hint: 0.1, 1
                    on_release: root.clear_sc_address()
                StandardButton:
                    id: UploadedSC
                    text: 'Load Uploaded SC'
                    size_hint: 0.2, 1
                    on_release: root.activate_uploaded_sc()
                    disabled: False
                StandardButton:
                    id: ExternalSC
                    text: 'Load External SC:'
                    size_hint: 0.2, 1
                    on_release: root.connect_to_sc()
                    disabled: False
                TextInput:
                    text: ''
                    id: ContractAddress
                    size_hint: 0.6, 1
            # Commands line
            BoxLayout:
                orientation: 'horizontal'
                spacing: 2.5
                padding: 2.5
                size_hint: 1, 0.08
                LabelDescription:
                    text: 'Payable commands'
                SeparateLabel:
                LabelDescription:
                    text: 'Nonpayable commands'
                SeparateLabel:
                LabelDescription:
                    text: 'View commands'
                SeparateLabel:
                ResetButton:
                    text: 'Update'
                    size_hint: 0.6, 1
                    on_release: root.update_prices()
                ResetButton:
                    size_hint: 0.6, 1
                    text: 'Reset Gas meter'
                    on_release: root.reset_gas_meter()
            SeparateLabel:
                size_hint: 1, 0.007
            # SC buttons
            BoxLayout:
                size_hint: 1, 0.55
                orientation: 'horizontal'
                size: root.width, root.height
                spacing: 5
                padding: 5
                ScrollView:
                    do_scroll_x: False
                    do_scroll_y: True
                    GridLayout:
                        id: payable_buttons
                        size_hint_y: None
                        height: self.minimum_height
                        cols: 1
                        orientation: 'tb-lr'
                        spacing: 2.5
                        padding: 2.5
                LineLabel:
                ScrollView:
                    do_scroll_x: False
                    do_scroll_y: True
                    GridLayout:
                        id: nonpayable_buttons
                        size_hint_y: None
                        height: self.minimum_height
                        cols: 1
                        orientation: 'tb-lr'
                        spacing: 2.5
                        padding: 2.5
                LineLabel:
                ScrollView:
                    do_scroll_x: False
                    do_scroll_y: True
                    GridLayout:
                        id: view_buttons
                        size_hint_y: None
                        height: self.minimum_height
                        cols: 1
                        orientation: 'tb-lr'
                        spacing: 2.5
                        padding: 2.5
                LineLabel:
                ScrollView:
                    do_scroll_x: False
                    do_scroll_y: True
                    size_hint: 1.2, 1
                    GridLayout:
                        size_hint_y: None
                        height: self.minimum_height
                        rows: 10
                        cols: 2
                        orientation: 'tb-lr'
                        spacing: 2.5
                        padding: 2.5
                        LabelDescription_2:
                            text: 'ETH Price'
                        LabelValue_2:
                            id: eth_price_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Wallet Balance'
                        LabelValue_2:
                            id: wallet_balance_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Network Active'
                        LabelValue_2:
                            id: network_active_sc
                            text: ''
                        # Row 2
                        LabelDescription_2:
                            text: 'Address Active'
                        LabelValue_2:
                            id: address_active_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Total Gas used'
                        LabelValue_2:
                            id: total_gas_used_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Total Gwei spent'
                        LabelValue_2:
                            id: total_gwei_spent_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Total USD spent:'
                        LabelValue_2:
                            id: total_usd_spent_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Last Gas spent'
                        LabelValue_2:
                            id: last_gas_spent_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Last Gwei spent'
                        LabelValue_2:
                            id: last_gwei_spent_sc
                            text: ''
                        LabelDescription_2:
                            text: 'Last USD spent'
                        LabelValue_2:
                            id: last_usd_spent_sc
                            text: ''
                # Gas Estimate
            GridLayout:
                rows: 1
                cols: 9
                spacing: 2.5
                padding: 2.5
                size_hint: 1, .08
                StandardButton:
                    text: 'Calculate'
                    disabled: True
                    id: calculate_transaction
                    size_hint: .5, 1
                    bold: True
                    on_release: root.calculate_transaction()
                SeparateLabel:
                StandardButton:
                    id: currency_selection
                    text: ''
                    on_release: root.currency_selection()
                    size_hint: .7, 1
                LabelDescription:
                    text: 'Gas Estimate'
                    size_hint: .7, 1
                LabelDescription:
                    text: 'Gas Cost'
                    size_hint: 0.7, 1
                LabelDescription:
                    text: 'Gas Cost (USD)'
                    size_hint: .8, 1
                LabelDescription:
                    text: 'Transaction Cost'
                    size_hint: .8, 1
                LabelDescription:
                    text: 'Transaction Cost (USD)'
                LabelDescription:
                    text: 'Verification Status'
                    size_hint: .9, 1
            GridLayout:
                rows: 1
                cols: 9
                spacing: 2.5
                padding: 2.5
                size_hint: 1, .08
                StandardButton:
                    text: 'Transact'
                    disabled: True
                    id: execute
                    size_hint: .5, 1
                    bold: True
                    on_release: root.transact()
                SeparateLabel:
                TextInput:
                    id: currency_input
                    font_size: 12
                    size_hint: .7, 1
                LabelValue:
                    id: gas_transaction
                    text: ''
                    size_hint: 0.7, 1
                LabelValue:
                    id: gas_cost_transaction
                    text: ''
                    size_hint: 0.7, 1
                LabelValue:
                    id: gas_cost_transaction_usd
                    text: ''
                    size_hint: .8, 1
                LabelValue:
                    id: gwei_cost_transaction
                    text: ''
                    size_hint: .8, 1
                LabelValue:
                    id: usd_cost_transaction
                    text: ''
                LabelValue:
                    id: verification_status_sc
                    text: ''
                    size_hint: .9, 1
            BoxLayout:
                orientation: 'horizontal'
                size: root.width, root.height
                spacing: 2.5
                padding: 2.5
                size_hint: 1, 0.35
                BoxLayout:
                    orientation: 'vertical'
                    size: root.width, root.height
                    spacing: 2.5
                    padding: 2.5
                    LabelDescription:
                        text: 'Inputs'
                        size_hint: 1, .25
                    ScrollView:
                        do_scroll_x: False
                        do_scroll_y: True
                        GridLayout:
                            size_hint_y: None
                            height: self.minimum_height
                            id: input_layout
                            cols: 2
                            orientation: 'lr-tb'
                            spacing: 2.5
                            padding: 2.5
                LineLabel:
                    size_hint: 0.008, 1
                BoxLayout:
                    orientation: 'vertical'
                    size: root.width, root.height
                    spacing: 2.5
                    padding: 2.5
                    LabelDescription:
                        text: 'Outputs'
                        size_hint: 1, .25
                        spacing: 2.5
                    ScrollView:
                        do_scroll_x: False
                        do_scroll_y: True
                        GridLayout:
                            size_hint_y: None
                            height: self.minimum_height
                            id: output_layout
                            cols: 1
                            orientation: 'lr-tb'
                            spacing: 2.5
            LabelValue:
                id: StatusBar_1
                font_size: 16
                size_hint: 1, 0.08
                text: 'Status bar'
# ######################################## SC Upload ##########################################
    TabbedPanelItem:
        id: sc_upload
        text: '[size=20][color=#ff8000][b]SC Upload[/b][/color][/size]'
        BoxLayout:
            # Background color in Tab
            orientation: 'vertical'
            padding: 3
            spacing: 2.5
            canvas:
                Color:
                    rgba: (1, 1/2, 0, 1)
                Rectangle:
                    size: self.size
                    pos: self.pos
            # Row 1
            BoxLayout:
                orientation: 'horizontal'
                size: root.width, root.height
                size_hint: 1, .2
                spacing: 3
                GridLayout:
                    rows: 2
                    cols: 7
                    spacing: 5
                    padding: 5
                    LabelDescription:
                        size_hint: .7, 1
                        text: 'ETH Price'
                    ######
                    StandardButton:
                        size_hint: .9, 1
                        text: 'Network Active'
                        id: network_switch
                        on_release: Factory.NetworkPopup().open()
                    ######
                    StandardButton:
                        size_hint: 1, 1
                        text: 'Address Active'
                        on_release: Factory.AddressPopup().open()
                        # on_release: root.ganache_private_key_enter()
                    LabelDescription:
                        size_hint: 1, 1
                        text: 'Wallet Balance'
                    LabelDescription:
                        size_hint: 1, 1
                        text: 'Gas Price (main)'
                    LabelDescription:
                        size_hint: 1, 1
                        text: 'Gas Price (USD)'
                    LabelDescription:
                        size_hint: 1.1, 1
                        text: 'Conf. Time (main)'
                    # Row 2
                    LabelValue:
                        id: ETH_Price
                        size_hint: .7, 1
                        text: ''
                    #####
                    LabelValue:
                        id: active_network
                        size_hint: .9, 1
                        text: ''
                    #####
                    LabelValue:
                        size_hint: 1, 1
                        id: address_active
                        text: ''
                    LabelValue:
                        id: Wallet_Balance
                        size_hint: 1, 1
                        text: ''
                    LabelValue:
                        id: Gas_Price
                        size_hint: 1, 1
                        text: ''
                    LabelValue:
                        id: Gas_Price_USD
                        size_hint: 1, 1
                        text: ''
                    LabelValue:
                        id: Conf_Time
                        size_hint: 1.1, 1
                        text: ''
                StandardButton:
                    size_hint: .08, 1
                    on_release: root.update_prices()
                    Image:
                        source: 'refresh.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: self.size
                StandardButton:
                    size_hint: .08, 1
                    on_release: Factory.SettingsPopup().open()
                    Image:
                        source: 'settings_icon.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: self.size
            SeparateLabel:
                size_hint: 1, 0.007
            BoxLayout:
                orientation: 'horizontal'
                size: root.width, root.height
                size_hint: 1, .2
                spacing: 3
                GridLayout:
                    rows: 2
                    cols: 7
                    spacing: 5
                    padding: 5
                    orientation: 'tb-lr'
                    StandardButton:
                        text: 'Set Compiler'
                        size_hint: 1.5, 1
                        on_release: Factory.CompilerPopup().open()
                    LabelValue:
                        id: compiler_set
                        text: ''
                        size_hint: 1.5, 1
                    LabelDescription:
                        text: 'Total Gwei spent'
                        size_hint: 1, 1
                    LabelValue:
                        id: total_gwei_spent
                        text: ''
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Total USD spent'
                        size_hint: 1, 1
                    LabelValue:
                        id: total_usd_spent
                        text: ''
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Last Gas spent'
                        size_hint: 1, 1
                    LabelValue:
                        id: last_gas_spent
                        text: ''
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Last Gwei spent'
                        size_hint: 1, 1
                    LabelValue:
                        id: last_gwei_spent
                        text: ''
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Last USD spent'
                        size_hint: 1, 1
                    LabelValue:
                        id: last_usd_spent
                        text: ''
                        size_hint: 1, 1
                StandardButton:
                    size_hint: .08, 1
                    on_release: root.reset_gas_meter()
                    Image:
                        source: 'reset.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: self.size
                StandardButton:
                    size_hint: .08, 1
                    on_release: Factory.GanachePopup().open()
                    Image:
                        source: 'ganache_icon.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: 65, 65
            LabelDescription:
                font_size: 16
                size_hint: 1, 0.08
                text: 'File selection'
# ####################################
            # Contract file load
            GridLayout:
                rows: 1
                cols: 4
                spacing: 5
                padding: 2.5
                size_hint: 1, .1
                StandardButton:
                    id: ChooseSC
                    text: 'Choose SC'
                    size_hint: .15, 1
                    on_release: root.file_chooser()
                    disabled: False
                StandardButton:
                    text: 'Clear'
                    size_hint: .15, 1
                    on_release: root.clear()
                StandardButton:
                    id: compile_sc
                    text: 'Compile'
                    size_hint: .15, 1
                    on_release: root.compile()
                    disabled: True
                TextInput:
                    font_size: 16
                    size_hint: .8, 1
                    id: FilePath
                    text: ''
                    valign: 'center'
            # Contract selection
            BoxLayout:
                orientation: 'horizontal'
                spacing: 5
                padding: 2.5
                size_hint: 1, 0.1
                LabelDescription:
                    id: select_sc
                    size_hint: 0.15, 1
                    text: 'Select SC:'
                    # on_release: root.select_subcontract()
                    # disabled: True
                ScrollView:
                    do_scroll_y: False
                    do_scroll_x: True
                    GridLayout:
                        size_hint_x: None
                        width: self.minimum_width
                        rows: 1
                        orientation: 'lr-tb'
                        spacing: 2.5
                        padding: 2.5
                        # size_hint: 1, 1
                        id: ContractSelection
            LabelDescription:
                text: 'Constructor'
                size_hint: 1, .08
            # Constructor
            BoxLayout:
                orientation: 'vertical'
                spacing: 2.5
                padding: 2.5
                size_hint: 1, .2
                ScrollView:
                    do_scroll_y: False
                    do_scroll_x: True
                    GridLayout:
                        size_hint_x: None
                        width: self.minimum_width
                        rows: 2
                        orientation: 'tb-lr'
                        id: Constructor
                        padding: 2.5
                        spacing: 2.5
                        size_hint: 1, 1
            # Smart Contract Operations
            LabelDescription:
                text: 'Smart Contract Operations'
                spacing: 3
                size_hint: 1, 0.08
            BoxLayout:
                orientation: 'horizontal'
                spacing: 2
                padding: 2
                size_hint: 1, 0.2
                GridLayout:
                    rows: 2
                    cols: 6
                    spacing: 3
                    padding: 3
                    size: root.width, root.height
                    size_hint: 1, 1
                    # Row 1
                    StandardButton:
                        id: Calculate
                        text: 'Calculate'
                        size_hint: .7, 1
                        on_release: root.calculate_upload()
                        disabled: True
                    LabelDescription:
                        text: 'Gas Estimate'
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Upload Cost'
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Gas Cost'
                        size_hint: .8, 1
                    LabelDescription:
                        text: 'Upload Cost (USD)'
                        size_hint: 1, 1
                    LabelDescription:
                        text: 'Gas Cost (USD)'
                        size_hint: 1, 1

                    # Row2
                    StandardButton:
                        id: DeploySC
                        text: 'Deploy SC'
                        size_hint: .7, 1
                        on_release: root.deploy_sc()
                        disabled: True
                    LabelValue:
                        text: ''
                        size_hint: 1, 1
                        id: GasEstimate
                    LabelValue:
                        text: ''
                        size_hint: 1, 1
                        id: UploadCost
                    LabelValue:
                        text: ''
                        size_hint: .8, 1
                        id: GasCost
                    LabelValue:
                        text: ''
                        size_hint: 1, 1
                        id: UploadCostUSD
                    LabelValue:
                        text: ''
                        size_hint: 1, 1
                        id: GasCostUSD
                StandardButton:
                    text: ''
                    size_hint: .1, 1
                    id: copy_contract_address
                    disabled: True
                    on_release: root.copy_contract_address()
                    Image:
                        source: 'copy_link.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: self.size
                StandardButton:
                    text: ''
                    size_hint: .1, 1
                    on_release: root.open_webpage()
                    disabled: True
                    id: contract_webpage
                    Image:
                        source: 'open_browser.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: self.size
                StandardButton:
                    text: ''
                    size_hint: .1, 1
                    Image:
                        source: 'verify.png'
                        center_x: self.parent.center_x
                        center_y: self.parent.center_y
                        size: self.size
            LabelValue:
                id: StatusBar
                font_size: 16
                size_hint: 1, 0.1
                text: 'Status bar'
# ############################################ Settings Panel ##################################